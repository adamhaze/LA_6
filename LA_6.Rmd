---
title: "Lab_6"
author: "Adam Hayes, Jasmine Sanchez, Erin Omyer, Richard Park"
date: "2/20/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
COflights <- read_csv("https://files.osf.io/v1/resources/3z5as4pej8/providers/osfstorage/5a8ca28f57103100104584db")


```

##The shorter the flight distance the increase in arrival delay
```{r}

ggplot(data = COflights) + geom_point(mapping = aes(x = DISTANCE, y = ARR_DELAY), color = 'blue', position = 'dodge', na.rm = TRUE) + coord_flip()

```
##When the distance of a flight decreases, the chances of an arrival delay are higher. The longer the flight distance, the less chance of an arrival delay. This means that a short flight distance increases the arrival delay.

##Having a weather delay in correlation with the flight's scheduled arrival time
```{r}
DEN_flights <- COflights%>%
  filter(DEST == "DEN")

ggplot(data = DEN_flights)+
  geom_point(aes(x = CRS_ARR_TIME,y = WEATHER_DELAY, colour = DISTANCE), position = "jitter",na.rm =TRUE)
```
##There is a strong trend between the scheduled arrival time of a flight landing in colorado and the number of flights that have also been delayed due to weather. As the scheduled arrival time increases (gets later), there is a higher chance of the flight being delayed due to weather. Therefore, having an earlier schuled flight time will contribute and more accurately lead to an on-time arrival.
##Also, as the distance of the flight decreases, there is another trend in higher opportunities for there being a delay in the flight due to weather. With that, it may also be more beneficial for flyers at a greater distance from Denver to decrease their chances of having a delayed flight due to weather. 

##Does carrier (United Airlines) cause more delays?
```{r}
Carrier_delays_total <- COflights%>%
  filter(!is.na(CARRIER_DELAY), DEST == 'DEN', CARRIER == 'UA')%>%
  count()
Carrier_delays_total

Carrier_delays <- COflights%>%
  filter(!is.na(CARRIER_DELAY), DEST == 'DEN', CARRIER == 'UA', CARRIER_DELAY >=15)%>%
  count()
Carrier_delays
Carrier_delays / Carrier_delays_total
```
##The probability above shows that carrier delays (specifically analyzing United Airlines) have approximately 29.8% of being delayed due to carrrier related issues. A flight is considered "delayed" if it arrives 15 or more minutes late and the probability of that happening for someone flying United, which is a major carrier, is 29.8%. 

##Does NAS (National Air System) cause more delays?
```{r}
NAS_delay_total <- COflights%>%
  filter(!is.na(NAS_DELAY), DEST == 'DEN')%>%
  count()
NAS_delay_total

NAS_delay <-COflights%>%
  filter(!is.na(NAS_DELAY), DEST == 'DEN', NAS_DELAY >=15)%>%
  count()
NAS_delay
NAS_delay / NAS_delay_total
```
##National Air System probability of being delayed is 30.9% which shows that all flights experience a 30.9% chance of there being a national air system delay. As previously explained, a flight is considered "delayed" if it arrives 15 or more minutes late. 

###Erin's Findings

#Probability of delayed flights to Denver with air time greater than 4 hours
```{r}
prob_delayDEN <- COflights %>%
  filter(ARR_DELAY > 0 & AIR_TIME > 240, DEST == 'DEN') %>%
  count()
total_delayDEN <- COflights %>%
  filter(ARR_DELAY > 0, DEST == 'DEN') %>%
  count()

prob_delayDEN/total_delayDEN
```
#Probability of delayed flights to Denver with air time less than 2 hours
```{r}
prob_delayDEN2 <- COflights %>%
  filter(ARR_DELAY > 5 & AIR_TIME < 120, DEST == 'DEN') %>%
  count()
total_delayDEN <- COflights %>%
  filter(ARR_DELAY > 0, DEST == 'DEN') %>%
  count()
prob_delayDEN2/total_delayDEN
```
#From the probabilities displayed above, as the air time increases, the probability of an arrival delay decreases. As the air time decreases, then the probability of an arrival delay increases. It is roughly around 4 percent probabilty of a delayed arrival for a flight longer than 4 hours. But, for flights less than 2 hour, there is a 40 percent probability of a delayed arrival. 


###Jasmine's Findings


#Probability of delayed arrivals to Denver with a flight distance greater than 1000 miles
```{r}
delayed_arrival <- COflights%>%
  filter(DEST == "DEN", DISTANCE > 1000 & ARR_DELAY >0)%>%
  count()

DEN_total_delay <- COflights%>%
  filter(DEST == "DEN", ARR_DELAY)%>%
  count()

DENVER <- delayed_arrival/DEN_total_delay
```

```{r echo=FALSE, results = 'asis'}
library(knitr)
kable(DENVER, caption = "Delayed Arrivals with Distance > 1000")
```

```{r}
library(tidyverse)
ggplot(data = COflights)+
    geom_point(mapping = aes(x= ARR_DELAY, y = DISTANCE > 1000, color = DISTANCE), position = "jitter", na.rm = TRUE)
```


#Probability of delayed arrivals to Denver with a flight distance less than 500 miles
```{r}
delayed_arrival_2 <- COflights%>%
  filter(DEST == "DEN", DISTANCE < 500 & ARR_DELAY >0)%>%
  count()

DENVER_2 <- delayed_arrival_2/DEN_total_delay

```

```{r echo=FALSE, results = 'asis'}
library(knitr)
kable(DENVER_2, caption = "Delayed Arrivals with Dsitance < 500")
```

```{r}
ggplot(data = COflights)+
    geom_point(mapping = aes(x= ARR_DELAY, y = DISTANCE < 500, color = DISTANCE), position = "jitter", na.rm = TRUE)
```
#As displayed by the probabilities above, there is a higher chance in the flights to Denver having a delayed arrival as the distance between states increases. This contradicts the earlier plot that had been discussed for all colorado flights with the weather delays showing opposing trends. 
#Also, as the distance between states decrease by half the distance, there is a 5.72% difference in flights having delayed arrivals into Denver, which is almost a 3x increase. 

###Richard's Findings

#Probability of delayed departure from Denver with an air time greater or equal to 60 minutes
```{r}
delayed_departure_total <- COflights%>%
  filter(ORIGIN == 'DEN', AIR_TIME)%>% 
  count()
delayed_departure_total

delayed_departure_air_time <- COflights%>%
  filter(AIR_TIME >=60, ORIGIN == 'DEN', DEP_DELAY)%>%
  count()
delayed_departure_air_time
delayed_departure_air_time / delayed_departure_total

```

#Probability of delayed departure from Denver with an air time less than 60 minutes 
```{r}
delayed_departure_air_time2 <- COflights%>%
  filter(AIR_TIME <60, ORIGIN == 'DEN', DEP_DELAY)%>%
  count()
delayed_departure_air_time2
delayed_departure_air_time2 / delayed_departure_total
```
#The probabilities above indicate that there is a higher chance of a delayed departure if the flight air time is an hour or less, whereas, the probability of there being a delayed departure when the air time is more than an hour is significantly lower. For a flight with an air time of an hour or less, there is a 88.3% chance of it being delayed and for flights with an air time greater than an hour, there is a 6.3% chance of it being delayed. That's a 82% difference between the two!
